# lifelihood

`lifelihood` is an R package and a class of continuous time multi-event
models which provide the joined likelihood of all the events in an
individual life-history (time of maturity, reproductive events, death).

[Documentation](https://nrode.github.io/Lifelihood/)

It requires R 4.1.0 or later, and:

- macOS (Apple silicon)
- Windows (Still some known issues)
- Linux

\

## Installation

``` r

devtools::install_github("nrode/Lifelihood")
```

\

## Quick start

``` r

library(lifelihood)

df <- fakesample
head(df)
df$type <- as.factor(df$type)
df$geno <- as.factor(df$geno)

clutchs <- c(
  "clutch_start1", "clutch_end1", "clutch_size1",
  "clutch_start2", "clutch_end2", "clutch_size2"
)

dataLFH <- as_lifelihoodData(
  df = df,
  sex = "sex",
  sex_start = "sex_start",
  sex_end = "sex_end",
  maturity_start = "mat_start",
  maturity_end = "mat_end",
  clutchs = clutchs,
  death_start = "death_start",
  death_end = "death_end",
  covariates = c("geno", "type"),
  model_specs = c("gam", "lgn", "wei")
)

results <- lifelihood(
  lifelihoodData = dataLFH,
  path_config = system.file("configs/config.yaml", package = "lifelihood"),
  seeds = c(1, 2, 3, 4)
)
summary(results)
#> === LIFELIHOOD RESULTS ===
#>
#> Sample size: 550
#>
#> --- Model Fit ---
#> Log-likelihood:  -30491.599
#> AIC:             61019.2
#> BIC:             61096.8
#>
#> --- Key Parameters ---
#>
#> Mortality:
#>   expt_death (Intercept)    -0.912 (0.000)
#>   expt_death eff_expt_death_par_1 -0.455 (0.000)
#>   expt_death eff_expt_death_par_2 0.121 (0.000)
#>   expt_death eff_expt_death_spore_1 -0.373 (0.000)
#>   expt_death eff_expt_death_spore_2 -0.303 (0.000)
#>   expt_death eff_expt_death_spore_3 -0.927 (0.000)
#>   survival_param2 (Intercept) -0.480 (0.000)
#>
#> Maturity:
#>   expt_maturity (Intercept) -1.527 (0.000)
#>   expt_maturity eff_expt_maturity_par_1 0.134 (0.000)
#>   expt_maturity eff_expt_maturity_par_2 0.074 (0.000)
#>   maturity_param2 (Intercept) -5.900 (0.000)
#>
#> Reproduction:
#>   expt_reproduction (Intercept) -1.780 (0.000)
#>   expt_reproduction eff_expt_reproduction_par_1 -1.742 (0.000)
#>   expt_reproduction eff_expt_reproduction_par_2 -1.166 (0.000)
#>   reproduction_param2 (Intercept) -7.517 (0.000)
#>   reproduction_param2 eff_reproduction_param2_par_1 0.222 (0.000)
#>   reproduction_param2 eff_reproduction_param2_par_2 0.776 (0.000)
#>   n_offspring (Intercept)   -2.543 (0.000)
#>
#> --- Convergence ---
#> All parameters within bounds
#>
#> ======================
```

## Goodness of fit

``` r

coeff(results, "expt_death")
#> int_expt_death  eff_expt_death_par_1  eff_expt_death_par_2  eff_expt_death_spore_1  eff_expt_death_spore_2  eff_expt_death_spore_3
#> -0.9116360      -0.4551437            0.1214695             -0.3729372              -0.3028974              -0.9274529

AIC(results)
#> 61019.2

BIC(results)
#> 61096.78

logLik(results)
#> -30491.6
```

## Prediction

``` r

prediction(results, "expt_death", type = "response") |> head()
#> 92.88023 92.88023 92.88023 92.88023 92.88023 92.88023
```

## Visualization

``` r

plot_fitted_event_rate(
  results,
  interval_width = 2,
  event = "mortality",
  use_facet = TRUE,
  groupby = "par",
  xlab = "Age (days)",
  ylab = "Fitted Mortality Rate",
)
```

![](img/example-1.png)

\

Learn more and find more examples in the
[documentation](https://nrode.github.io/Lifelihood/).

# Package index

## All functions

- [`AIC(`*`<lifelihoodResults>`*`)`](https://nrode.github.io/Lifelihood/reference/AIC.lifelihoodResults.md)
  : Akaike Information Criterion
- [`AICc()`](https://nrode.github.io/Lifelihood/reference/AICc.md) :
  Akaike Information Criterion for small sample size
- [`BIC(`*`<lifelihoodResults>`*`)`](https://nrode.github.io/Lifelihood/reference/BIC.lifelihoodResults.md)
  : Bayesian Information Criterion
- [`as_lifelihoodData()`](https://nrode.github.io/Lifelihood/reference/as_lifelihoodData.md)
  : Data object for lifelihood
- [`coef(`*`<lifelihoodResults>`*`)`](https://nrode.github.io/Lifelihood/reference/coef.md)
  [`coeff()`](https://nrode.github.io/Lifelihood/reference/coef.md) :
  Coefficient estimates
- [`compute_fitted_event_rate()`](https://nrode.github.io/Lifelihood/reference/compute_fitted_event_rate.md)
  : Compute fitted mortality rate
- [`compute_observed_event_rate()`](https://nrode.github.io/Lifelihood/reference/compute_observed_event_rate.md)
  : Compute empirical event rate
- [`compute_reproduction_intervals()`](https://nrode.github.io/Lifelihood/reference/compute_reproduction_intervals.md)
  : Compute time interval between clutches
- [`datapierrick`](https://nrode.github.io/Lifelihood/reference/datapierrick.md)
  : Pierrick data
- [`default_bounds_df()`](https://nrode.github.io/Lifelihood/reference/default_bounds_df.md)
  : Get dataframe with default parameter boundaries
- [`fakesample`](https://nrode.github.io/Lifelihood/reference/fakesample.md)
  : Fake sample
- [`lifelihood()`](https://nrode.github.io/Lifelihood/reference/lifelihood.md)
  : Individual life history modelling
- [`logLik(`*`<lifelihoodResults>`*`)`](https://nrode.github.io/Lifelihood/reference/logLik.lifelihoodResults.md)
  : Likelihood
- [`mcmc()`](https://nrode.github.io/Lifelihood/reference/mcmc.md) :
  MCMC
- [`parallel.simulate()`](https://nrode.github.io/Lifelihood/reference/parallel.simulate.md)
  : Parallelized simulations
- [`prediction()`](https://nrode.github.io/Lifelihood/reference/prediction.md)
  : Prediction with lifelihood estimations
- [`remove_lifelihood_tempfiles()`](https://nrode.github.io/Lifelihood/reference/remove_lifelihood_tempfiles.md)
  : Remove all lifelihood temporary files
- [`simulate_life_history()`](https://nrode.github.io/Lifelihood/reference/simulate_life_history.md)
  : Simulate outcomes from a fitted lifelihood model
- [`summary(`*`<lifelihoodResults>`*`)`](https://nrode.github.io/Lifelihood/reference/summary.lifelihoodResults.md)
  : Simple summary for lifelihoodResults objects
- [`use_test_config()`](https://nrode.github.io/Lifelihood/reference/use_test_config.md)
  : Get the path to a built-in configuration file.
- [`vcov(`*`<lifelihoodResults>`*`)`](https://nrode.github.io/Lifelihood/reference/vcov.lifelihoodResults.md)
  : Covariance matrix

# Articles

### Tutorials

- [Required data
  format](https://nrode.github.io/Lifelihood/articles/required-data-format.md):
- [Setting up configuration
  file](https://nrode.github.io/Lifelihood/articles/setting-up-the-configuration-file.md):
- [How to use
  lifelihood](https://nrode.github.io/Lifelihood/articles/how-to-use-lifelihood.md):
- [Customize parameter boundaries and estimation
  warning](https://nrode.github.io/Lifelihood/articles/customize-parameter-boundaries-and-estimation-warning.md):
- [Simulation and visit
  masks](https://nrode.github.io/Lifelihood/articles/simulation-and-visit-masks.md):
- [Fit saturated model using \`group_by_group =
  TRUE\`](https://nrode.github.io/Lifelihood/articles/fit-saturated-model.md):
- [Standard errors and
  MCMC](https://nrode.github.io/Lifelihood/articles/standard-errors-and-mcmc.md):
- [Generate clutch
  names](https://nrode.github.io/Lifelihood/articles/generate-clutch-names.md):

### Developer

- [Overview](https://nrode.github.io/Lifelihood/articles/overview.md):
- [Contributing](https://nrode.github.io/Lifelihood/articles/contributing.md):
- [Compilation](https://nrode.github.io/Lifelihood/articles/compilation.md):
