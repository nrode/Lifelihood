---
title: "Overview"
vignette: >
  %\VignetteIndexEntry{overview}
  %\VignetteEngine{quarto::html}
  %\VignetteEncoding{UTF-8}
knitr:
  opts_chunk:
    collapse: true
    comment: '#>'
---

# How Lifelihood Works

This document provides an overview of the internal workings of the **Lifelihood** R package. It is intended for developers and contributors who wish to understand or extend the package's functionality.

## Introduction

**Lifelihood** is an R package designed for complex quantitative biology and survival analysis calculations. To achieve high computational performance, core calculations are performed using **Rust** code, which is integrated into the R package through an interface layer.

## Package Structure

The **Lifelihood** package is organized into the following primary components:

1. **R Interface**: Provides user-facing functions and a set of helper functions for input validation, data preprocessing, and postprocessing of results. Most code lives in the `R/` directory.
2. **Rust Backend**: Manages core computational tasks for survival analysis, allowing for performance-optimized calculations that would be challenging to achieve solely in R. Most code lives in the `src/` directory.
3. **Interface Layer**: Facilitates communication between R and Rust.

### Directory Structure

The key directories and files in the package are organized as follows:

- `vignettes/`: Quarto files used for the documentation website.
- `R/`: Contains all R functions, user interface code, and helper functions.
- `src/`: Houses the Rust source code.
- `inst/`: Utility files used such as the binary files and config examples.
- `man/`: Documentation files for each function, generated via Roxygen2.
- `tests/`: Unit and integration tests for validating package functionality.
- `DESCRIPTION`: Provides metadata about the package (authors, version, description, etc.).
- `NAMESPACE`: Specifies the functions exported from Lifelihood.
- `Cargo.toml` & `Cargo.lock`: configuration file and dependencies for Rust

```
lifelihood/
├── vignettes/
├── R/
├── src/
├── inst/
│   ├── bin/
│   └── configs/
├── tests/
├── man/
├── DESCRIPTION
├── NAMESPACE
└── ...
```

## Integration with Rust Code

### Rust to R Interface

The core calculations in **Lifelihood** are implemented in **Rust** to optimize computational efficiency. Here's how the R and Rust components interact.

The Rust program requires two different input `txt` files:

- A configuration and data file
- A parameter boundaries file specifying the range of each parameter

Rust will parse those files and outputs a results file containing estimates, likelihoods, etc. On the other side, R will parse the output file.

### Rust Code

Unlike R, Rust is a compiled programming language, meaning the code must first be compiled into a machine-readable format (binary) before execution. Additionally, it must be compiled separately for both macOS, Windows and Linux.

The binary files (one for each OS) are meant to be in in the `inst/bin/` since this directory is used to include additional files when building the package. A utility function in **Lifelihood** determines the user's operating system to run the appropriate executable.
