test_that("Parsing the effect estimation values.", {
  lines <- c(
    "---------------------------",
    "",
    "datafile= /Users/josephbarbier/Desktop/Lifelihood/lifelihood_11_22_33_44/temp_file_data_lifelihood.txt",
    "seed1= 11 seed2= 22 seed3= 33 seed4= 44",
    "#parameters= 51",
    "Likelihood_max= -34138.741217",
    "int_expt_death -0.83129999 0.00000000",
    "eff_expt_death_geno1 0.92947536 0.00000000",
    "eff_expt_death_type1 1.30265247 0.00000000",
    "eff_expt_death_type2 -0.73748941 0.00000000",
    "int_survival_shape -3.40298455 0.00000000",
    "eff_survival_shape_geno1 0.02515092 0.00000000",
    "eff_survival_shape_type1 0.92915890 0.00000000",
    "eff_survival_shape_type2 0.16760327 0.00000000",
    "eff_survival_shape_type1:geno1 -0.68288974 0.00000000",
    "eff_survival_shape_type2:geno1 -0.36220195 0.00000000",
    "int_ratio_expt_death -0.12793125 0.00000000",
    "eff_ratio_expt_death_geno1 0.28604559 0.00000000",
    "int_prob_death -0.89803406 0.00000000",
    "eff_prob_death_geno1 1.07953681 0.00000000",
    "int_expt_maturity -2.02472212 0.00000000",
    "eff_expt_maturity_geno1 0.40676542 0.00000000",
    "eff_expt_maturity_type1 -0.69772452 0.00000000",
    "eff_expt_maturity_type2 -0.23691474 0.00000000",
    "int_maturity_shape -2.94007876 0.00000000",
    "eff_maturity_shape_geno1 -0.74856079 0.00000000",
    "int_ratio_expt_maturity 0.68829873 0.00000000",
    "eff_ratio_expt_maturity_geno1 0.95205594 0.00000000",
    "eff_ratio_expt_maturity_type1 0.68317684 0.00000000",
    "eff_ratio_expt_maturity_type2 -0.84308360 0.00000000",
    "int_expt_reproduction -2.94508391 0.00000000",
    "eff_expt_reproduction_geno1 0.98866496 0.00000000",
    "int_pontn -3.03533456 0.00000000",
    "eff_pontn_geno1 0.00882649 0.00000000",
    "int_increase_death_hazard 0.32046805 0.00000000",
    "eff_increase_death_hazard_geno1 0.10915342 0.00000000",
    "eff_increase_death_hazard_type1 -0.05036526 0.00000000",
    "eff_increase_death_hazard_type2 -1.04708899 0.00000000",
    "eff_increase_death_hazard_type1:geno1 -0.33091387 0.00000000",
    "eff_increase_death_hazard_type2:geno1 0.45198851 0.00000000",
    "int_tof_reduction_date 0.28084201 0.00000000",
    "eff_tof_reduction_date_geno1 -0.88570395 0.00000000",
    "int_increase_tof_n_offspring -0.46231072 0.00000000",
    "eff_increase_tof_n_offspring_geno1 0.28953610 0.00000000",
    "int_lin_decrease_hazard 3.21667478 0.00000000",
    "eff_lin_decrease_hazard_geno1 3.23412570 0.00000000",
    "eff_lin_decrease_hazard_type1 -0.63547821 0.00000000",
    "eff_lin_decrease_hazard_type2 0.01897814 0.00000000",
    "eff_lin_decrease_hazard_type1:geno1 0.19396080 0.00000000",
    "eff_lin_decrease_hazard_type2:geno1 -0.52252978 0.00000000",
    "int_quad_senescence 1.43296146 0.00000000",
    "eff_quad_senescence_geno1 1.08471966 0.00000000",
    "int_quad_decrease_hazard -0.14656939 0.00000000",
    "eff_quad_decrease_hazard_geno1 -0.01577276 0.00000000",
    "int_quad_change_n_offspring 0.08552745 0.00000000",
    "eff_quad_change_n_offspring_geno1 0.15430663 0.00000000",
    "int_tof_n_offspring 0.08740353 0.00000000",
    "",
    "",
    "Parameter_Range_Table",
    "expt_death 0.00100000 24.00000000",
    "survival_shape 0.05000000 1000.00000000",
    "ratio_expt_death 0.01000000 100.00000000",
    "prob_death 0.00001000 0.99999000",
    "sex_ratio 0.00001000 0.99999000",
    "expt_maturity 0.00100000 2000.00000000",
    "maturity_shape 0.00250000 10.00000000",
    "ratio_expt_maturity 0.01000000 100.00000000",
    "expt_reproduction 0.00100000 10.00000000",
    "reproduction_shape 0.00250000 10.00000000",
    "pontn 1.00000000 50.00000000",
    "increase_death_hazard 0.00001000 10.00000000",
    "tof_reduction_date 0.00000010 10.00000000",
    "increase_tof_n_offspring 0.00000010 10.00000000",
    "lin_decrease_hazard -20.00000000 20.00000000",
    "quad_senescence -20.00000000 20.00000000",
    "quad_decrease_hazard -10.00000000 10.00000000",
    "quad_change_n_offspring -10.00000000 10.00000000",
    "tof_n_offspring -10.00000000 10.00000000",
    "ratiomax 10",
    "tinf_(right_censoring) 1000",
    "tc_(juvenile_period_length) 20"
  )
  result <- lifelihood:::get_effects(lines)
  expected <- data.frame(
    name = c(
      "int_expt_death",
      "eff_expt_death_geno1",
      "eff_expt_death_type1",
      "eff_expt_death_type2",
      "int_survival_shape",
      "eff_survival_shape_geno1",
      "eff_survival_shape_type1",
      "eff_survival_shape_type2",
      "eff_survival_shape_type1:geno1",
      "eff_survival_shape_type2:geno1",
      "int_ratio_expt_death",
      "eff_ratio_expt_death_geno1",
      "int_prob_death",
      "eff_prob_death_geno1",
      "int_expt_maturity",
      "eff_expt_maturity_geno1",
      "eff_expt_maturity_type1",
      "eff_expt_maturity_type2",
      "int_maturity_shape",
      "eff_maturity_shape_geno1",
      "int_ratio_expt_maturity",
      "eff_ratio_expt_maturity_geno1",
      "eff_ratio_expt_maturity_type1",
      "eff_ratio_expt_maturity_type2",
      "int_expt_reproduction",
      "eff_expt_reproduction_geno1",
      "int_pontn",
      "eff_pontn_geno1",
      "int_increase_death_hazard",
      "eff_increase_death_hazard_geno1",
      "eff_increase_death_hazard_type1",
      "eff_increase_death_hazard_type2",
      "eff_increase_death_hazard_type1:geno1",
      "eff_increase_death_hazard_type2:geno1",
      "int_tof_reduction_date",
      "eff_tof_reduction_date_geno1",
      "int_increase_tof_n_offspring",
      "eff_increase_tof_n_offspring_geno1",
      "int_lin_decrease_hazard",
      "eff_lin_decrease_hazard_geno1",
      "eff_lin_decrease_hazard_type1",
      "eff_lin_decrease_hazard_type2",
      "eff_lin_decrease_hazard_type1:geno1",
      "eff_lin_decrease_hazard_type2:geno1",
      "int_quad_senescence",
      "eff_quad_senescence_geno1",
      "int_quad_decrease_hazard",
      "eff_quad_decrease_hazard_geno1",
      "int_quad_change_n_offspring",
      "eff_quad_change_n_offspring_geno1",
      "int_tof_n_offspring"
    ),
    estimation = c(
      -0.83129999,
      0.92947536,
      1.30265247,
      -0.73748941,
      -3.40298455,
      0.02515092,
      0.92915890,
      0.16760327,
      -0.68288974,
      -0.36220195,
      -0.12793125,
      0.28604559,
      -0.89803406,
      1.07953681,
      -2.02472212,
      0.40676542,
      -0.69772452,
      -0.23691474,
      -2.94007876,
      -0.74856079,
      0.68829873,
      0.95205594,
      0.68317684,
      -0.84308360,
      -2.94508391,
      0.98866496,
      -3.03533456,
      0.00882649,
      0.32046805,
      0.10915342,
      -0.05036526,
      -1.04708899,
      -0.33091387,
      0.45198851,
      0.28084201,
      -0.88570395,
      -0.46231072,
      0.28953610,
      3.21667478,
      3.23412570,
      -0.63547821,
      0.01897814,
      0.19396080,
      -0.52252978,
      1.43296146,
      1.08471966,
      -0.14656939,
      -0.01577276,
      0.08552745,
      0.15430663,
      0.08740353
    ),
    stderror = c(
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000,
      0.00000000
    )
  )
  expect_equal(result, expected)
})
